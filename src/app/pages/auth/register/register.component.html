<section class="my-10 space-y-6">
  <h1 class="text-base-content text-center text-4xl font-bold">
    {{ "auth.register.title" | translate }}
  </h1>
  <div class="bg-base-200 mx-auto max-w-xl space-y-4 rounded-lg p-10 shadow">
    <form [formGroup]="registerForm" (ngSubmit)="register()" class="space-y-4">
      <!-- Display Name -->
      @let displayName = registerForm.controls.displayName;
      @let displayNamePlaceholder = "auth.register.displayName" | translate;

      <div class="space-y-2">
        <label class="floating-label">
          <span>
            {{ displayNamePlaceholder }}
          </span>
          <input
            formControlName="displayName"
            type="text"
            class="input input-md w-full"
            [placeholder]="displayNamePlaceholder"
            autocomplete="given-name"
          />
        </label>

        @if (displayName.touched && displayName.errors) {
          <ul class="text-error list-inside list-disc space-y-1 text-sm">
            @if (displayName.hasError("required")) {
              <li>
                {{
                  "validations.required"
                    | translate: { field: displayNamePlaceholder }
                }}
              </li>
            }
            @if (displayName.hasError("maxlength")) {
              <li>
                {{
                  "validations.maxlength"
                    | translate: { field: displayNamePlaceholder, max: 50 }
                }}
              </li>
            }
          </ul>
        }
      </div>
      <!-- Display Name -->

      <!-- Email -->
      @let email = registerForm.controls.email;
      @let emailPlaceholder = "auth.register.email" | translate;

      <div class="space-y-2">
        <label class="floating-label">
          <span>
            {{ emailPlaceholder }}
          </span>
          <input
            formControlName="email"
            type="email"
            class="input input-md w-full"
            [placeholder]="emailPlaceholder"
            autocomplete="email"
          />
        </label>

        @if (email.touched && email.errors) {
          <ul class="text-error list-inside list-disc space-y-1 text-sm">
            @if (email.hasError("required")) {
              <li>
                {{
                  "validations.required"
                    | translate: { field: emailPlaceholder }
                }}
              </li>
            }
            @if (email.hasError("email")) {
              <li>
                {{
                  "validations.email" | translate: { field: emailPlaceholder }
                }}
              </li>
            }
          </ul>
        }
      </div>
      <!-- Email -->

      <!-- Display Name -->
      @let userName = registerForm.controls.userName;
      @let userNamePlaceholder = "auth.register.userName" | translate;

      <div class="space-y-2">
        <label class="floating-label">
          <span>
            {{ userNamePlaceholder }}
          </span>
          <input
            formControlName="userName"
            type="text"
            class="input input-md w-full"
            [placeholder]="userNamePlaceholder"
            autocomplete="username"
          />
        </label>

        @if (userName.touched && userName.errors) {
          <ul class="text-error list-inside list-disc space-y-1 text-sm">
            @if (userName.hasError("required")) {
              <li>
                {{
                  "validations.required"
                    | translate: { field: userNamePlaceholder }
                }}
              </li>
            }
            @if (userName.hasError("maxlength")) {
              <li>
                {{
                  "validations.maxlength"
                    | translate: { field: userNamePlaceholder, max: 50 }
                }}
              </li>
            }
          </ul>
        }
      </div>
      <!-- Display Name -->

      <!-- Password -->
      @let password = registerForm.controls.password;
      @let passwordPlaceholder = "auth.register.password" | translate;

      <div class="space-y-2">
        <label class="floating-label">
          <span>
            {{ passwordPlaceholder }}
          </span>
          <input
            formControlName="password"
            type="password"
            class="input input-md w-full"
            [placeholder]="passwordPlaceholder"
            autocomplete="current-password"
          />
        </label>

        @if (password.touched && password.errors) {
          <ul
            [class]="{
              'list-disc': password.hasError('required'),
              'list-decimal': password.hasError('pattern'),
            }"
            class="text-error list-inside space-y-1 text-sm"
          >
            @if (password.hasError("required")) {
              <li>
                {{
                  "validations.required"
                    | translate: { field: passwordPlaceholder }
                }}
              </li>
            }
            @if (password.hasError("pattern")) {
              <h4 class="font-semibold">
                {{
                  "validations.pattern.password.requirements.title" | translate
                }}
              </h4>
              @for (rule of 5 | range; track $index) {
                <li class="ps-4">
                  {{ `validations.pattern.password.requirements.rules.${$index}` | translate }}
                </li>
              }
            }
          </ul>
        }
      </div>
      <!-- Password -->

      <!-- Confirm Password -->
      @let confirmPassword = registerForm.controls.confirmPassword;
      @let confirmPasswordPlaceholder =
        "auth.register.confirmPassword" | translate;

      <div class="space-y-2">
        <label class="floating-label">
          <span>
            {{ confirmPasswordPlaceholder }}
          </span>
          <input
            formControlName="confirmPassword"
            type="password"
            class="input input-md w-full"
            [placeholder]="confirmPasswordPlaceholder"
            autocomplete="current-password"
          />
        </label>

        @if (registerForm.errors || confirmPassword.errors) {
          <ul class="text-error list-inside list-disc space-y-1 text-sm">
            @if (
              confirmPassword.touched && confirmPassword.hasError("required")
            ) {
              <li>
                {{
                  "validations.required"
                    | translate: { field: confirmPasswordPlaceholder }
                }}
              </li>
            }
            @if (confirmPassword.touched && registerForm.hasError("nomatch")) {
              <li>
                {{
                  "validations.pattern.passwordMatch"
                    | translate: { field: confirmPasswordPlaceholder }
                }}
              </li>
            }
          </ul>
        }
      </div>
      <!-- Confirm Password -->

      <!-- Phone Number -->
      @let phoneNumber = registerForm.controls.phoneNumber;
      @let phoneNumberPlaceholder = "auth.register.phone" | translate;

      <div class="space-y-2">
        <label class="floating-label">
          <span>
            {{ phoneNumberPlaceholder }}
          </span>
          <input
            formControlName="phoneNumber"
            type="text"
            class="input input-md w-full"
            [placeholder]="phoneNumberPlaceholder"
            autocomplete="tel"
          />
        </label>

        @if (phoneNumber.touched && phoneNumber.errors) {
          <ul class="text-error list-inside list-disc space-y-1 text-sm">
            @if (phoneNumber.hasError("required")) {
              <li>
                {{
                  "validations.required"
                    | translate: { field: phoneNumberPlaceholder }
                }}
              </li>
            }
            @if (phoneNumber.hasError("pattern")) {
              <li>
                {{
                  "validations.pattern.phone"
                    | translate: { field: phoneNumberPlaceholder }
                }}
              </li>
            }
          </ul>
        }
      </div>
      <!-- Phone Number -->

      <!-- Address -->
      @let address = registerForm.controls.address;
      <fieldset
        [formGroup]="registerForm.controls.address"
        class="fieldset rounded-box border-base-content/25 -mt-4 space-y-4 border p-4"
      >
        <legend class="fieldset-legend">
          {{ "auth.register.address.title" | translate }}
        </legend>

        <!-- Street -->
        @let street = address.controls.street;
        @let streetPlaceholder = "auth.register.address.street" | translate;
        <div class="space-y-2">
          <label class="floating-label">
            <span>
              {{ streetPlaceholder }}
            </span>
            <input
              formControlName="street"
              type="text"
              class="input input-md w-full"
              [placeholder]="streetPlaceholder"
              autocomplete="address-level1"
            />
          </label>

          @if (street.touched && street.errors) {
            <ul class="text-error list-inside list-disc space-y-1 text-sm">
              @if (street.hasError("required")) {
                <li>
                  {{
                    "validations.required"
                      | translate: { field: streetPlaceholder }
                  }}
                </li>
              }

              @if (street.hasError("maxlength")) {
                <li>
                  {{
                    "validations.maxlength"
                      | translate: { field: streetPlaceholder, max: 50 }
                  }}
                </li>
              }
            </ul>
          }
        </div>
        <!-- Street -->

        <!-- City -->
        @let city = address.controls.city;
        @let cityPlaceholder = "auth.register.address.city" | translate;

        <div class="space-y-2">
          <label class="floating-label">
            <span>
              {{ cityPlaceholder }}
            </span>
            <input
              formControlName="city"
              type="text"
              class="input input-md w-full"
              [placeholder]="cityPlaceholder"
              autocomplete="address-level2"
            />
          </label>
          @if (city.touched && city.errors) {
            <ul class="text-error list-inside list-disc space-y-1 text-sm">
              @if (city.hasError("required")) {
                <li>
                  {{
                    "validations.required"
                      | translate: { field: cityPlaceholder }
                  }}
                </li>
              }

              @if (city.hasError("maxlength")) {
                <li>
                  {{
                    "validations.maxlength"
                      | translate: { field: cityPlaceholder, max: 50 }
                  }}
                </li>
              }
            </ul>
          }
        </div>
        <!-- City -->

        <!-- Country -->
        @let country = address.controls.country;
        @let countryPlaceholder = "auth.register.address.country" | translate;

        <div class="space-y-2">
          <label class="floating-label">
            <span>
              {{ countryPlaceholder }}
            </span>
            <input
              formControlName="country"
              type="text"
              [placeholder]="countryPlaceholder"
              class="input input-md w-full"
              autocomplete="country-name"
            />
          </label>

          @if (country.touched && country.errors) {
            <ul class="text-error list-inside list-disc space-y-1 text-sm">
              @if (country.hasError("required")) {
                <li>
                  {{
                    "validations.required"
                      | translate: { field: countryPlaceholder }
                  }}
                </li>
              }
              @if (country.hasError("maxlength")) {
                <li>
                  {{
                    "validations.maxlength"
                      | translate: { field: countryPlaceholder, max: 50 }
                  }}
                </li>
              }
            </ul>
          }
        </div>
        <!-- Country -->
      </fieldset>
      <!-- Address -->

      <div class="flex items-center justify-center">
        <button type="submit" class="btn btn-primary">
          {{ "auth.register.registerBtn" | translate }}
        </button>
      </div>
      <p class="flex items-center gap-2">
        {{ "auth.register.loginNavigation.title" | translate }}
        <a
          [routerLink]="['/auth', 'login']"
          class="link link-primary flex items-center gap-2 font-medium no-underline"
        >
          <span>
            {{ "auth.register.loginNavigation.link" | translate }}
          </span>
          <i
            [class]="{
              'fa-arrow-right': currLang() === 'en',
              'fa-arrow-left': currLang() === 'ar',
            }"
            class="fa-solid"
          ></i>
        </a>
      </p>
    </form>
    @if (errorMsg()) {
      <div role="alert" class="alert alert-error">
        <span> {{ errorMsg() }} </span>
      </div>
    }
  </div>
</section>
